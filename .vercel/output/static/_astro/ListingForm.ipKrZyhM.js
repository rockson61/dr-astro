import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as x}from"./index.JXKNaeUN.js";import{c as v}from"./supabase.svVmE_Zl.js";import{G as j}from"./GlassCard.Cfd5MXeQ.js";import{S as w}from"./store.C13YwLBx.js";import{M as N}from"./map-pin.BS-Bos_t.js";import{c as m}from"./createLucideIcon.BhldaWgv.js";import{G as S}from"./globe.CSA5frsJ.js";import{F as k}from"./file-text.D17FhZid.js";import{L as _}from"./loader-circle.ofVaKFwt.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],L=m("check",C);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],I=m("phone",E),c=v(),F=[{value:"clinic",label:"Dental Clinic"},{value:"lab",label:"Dental Laboratory"},{value:"supplier",label:"Equipment Supplier"},{value:"education",label:"Training Institute"},{value:"other",label:"Other"}],T=["General Dentistry","Orthodontics","Implants","Cosmetic","Pediatric","Oral Surgery","Periodontics","Endodontics","Prosthodontics"];function J({initialData:t}){const[u,p]=x.useState(!1),[s,b]=x.useState({business_name:t?.business_name||"",type:t?.type||"clinic",city:t?.address_json?.city||"",address:t?.address_json?.full_address||"",phone:t?.contact_phone||"",website:t?.website||"",description:t?.description||"",services:t?.amenities||[],images:t?.gallery||[]}),n=r=>{b({...s,[r.target.name]:r.target.value})},g=r=>{const a=s.services||[],i=a.includes(r)?a.filter(o=>o!==r):[...a,r];b({...s,services:i})},h=r=>r.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,""),f=async r=>{r.preventDefault(),p(!0);try{const{data:{user:a}}=await c.auth.getUser();if(!a)throw new Error("Not authenticated");const i={full_address:s.address,city:s.city,country:"India"},o={business_name:s.business_name,type:s.type,description:s.description,contact_phone:s.phone,website:s.website,address_json:i,amenities:s.services,gallery:s.images,updated_at:new Date().toISOString()};let l;if(t?.id){const{error:d}=await c.from("listings").update(o).eq("id",t.id);l=d}else{const d=`${h(s.business_name)}-${Math.random().toString(36).substring(2,7)}`,{error:y}=await c.from("listings").insert({...o,slug:d,owner_id:a.id,is_verified:!1,rating_avg:0});l=y}if(l)throw l;window.location.href="/dashboard/my-listings"}catch(a){console.error(a),alert(a.message||"Failed to save listing")}finally{p(!1)}};return e.jsxs(j,{className:"max-w-5xl mx-auto p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-3xl font-bold text-tuio-navy uppercase flex items-center gap-3",children:[e.jsx(w,{className:"w-8 h-8 text-tuio-red"}),t?"Edit Listing":"Add New Listing"]}),e.jsx("p",{className:"text-gray-500 mt-1",children:t?"Update your business details.":"List your business in the dental directory."})]}),e.jsx("a",{href:"/dashboard/my-listings",className:"text-gray-400 font-bold hover:text-tuio-red transition-colors flex items-center gap-2 text-sm uppercase tracking-wide",children:"â† Back"})]}),e.jsxs("form",{onSubmit:f,className:"space-y-8",children:[e.jsxs("div",{className:"bg-white/50 p-6 rounded-2xl border border-gray-100",children:[e.jsx("h3",{className:"font-bold text-lg text-tuio-navy mb-4 border-b border-gray-100 pb-2",children:"Business Details"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2",children:"Business Name *"}),e.jsx("input",{type:"text",name:"business_name",required:!0,value:s.business_name,onChange:n,placeholder:"e.g. Smile Dental Clinic",className:"w-full px-5 py-4 rounded-xl border border-gray-200 focus:ring-2 focus:ring-tuio-red focus:border-transparent outline-none transition-all"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2",children:"Type *"}),e.jsx("select",{name:"type",value:s.type,onChange:n,className:"w-full px-5 py-4 rounded-xl border border-gray-200 bg-white focus:ring-2 focus:ring-tuio-red focus:border-transparent outline-none transition-all",children:F.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2",children:"City *"}),e.jsx("input",{type:"text",name:"city",required:!0,value:s.city,onChange:n,placeholder:"e.g. Mumbai",className:"w-full px-5 py-4 rounded-xl border border-gray-200 focus:ring-2 focus:ring-tuio-red focus:border-transparent outline-none transition-all"})]})]})]})]}),e.jsxs("div",{className:"bg-white/50 p-6 rounded-2xl border border-gray-100",children:[e.jsx("h3",{className:"font-bold text-lg text-tuio-navy mb-4 border-b border-gray-100 pb-2",children:"Contact Information"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2",children:"Full Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(N,{className:"absolute left-3 top-3.5 h-5 w-5 text-gray-400"}),e.jsx("textarea",{name:"address",rows:2,value:s.address,onChange:n,className:"w-full pl-10 pr-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-tuio-red focus:border-transparent outline-none transition-all",placeholder:"Full street address..."})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2",children:"Phone"}),e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-3.5 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"tel",name:"phone",value:s.phone,onChange:n,className:"w-full pl-10 pr-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-tuio-red focus:border-transparent outline-none transition-all",placeholder:"+91..."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2",children:"Website"}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-3.5 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"url",name:"website",value:s.website,onChange:n,className:"w-full pl-10 pr-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-tuio-red focus:border-transparent outline-none transition-all",placeholder:"https://..."})]})]})]})]})]}),e.jsxs("div",{className:"bg-white/50 p-6 rounded-2xl border border-gray-100",children:[e.jsx("h3",{className:"font-bold text-lg text-tuio-navy mb-4 border-b border-gray-100 pb-2",children:"About & Services"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2",children:"Description *"}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-3 top-3.5 h-5 w-5 text-gray-400"}),e.jsx("textarea",{name:"description",required:!0,rows:5,value:s.description,onChange:n,className:"w-full pl-10 pr-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-tuio-red focus:border-transparent outline-none transition-all",placeholder:"Tell us about your business..."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-widest mb-4",children:"Services Offered"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:T.map(r=>e.jsxs("button",{type:"button",onClick:()=>g(r),className:`px-4 py-2 rounded-full text-sm font-bold border transition-all flex items-center gap-2 ${s.services.includes(r)?"bg-tuio-navy text-white border-tuio-navy shadow-md":"bg-white text-gray-500 border-gray-200 hover:border-gray-300"}`,children:[s.services.includes(r)&&e.jsx(L,{className:"w-3 h-3"}),r]},r))})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx("button",{type:"submit",disabled:u,className:"px-8 py-4 bg-tuio-red text-white rounded-xl font-bold uppercase tracking-wide hover:bg-tuio-navy transition-all shadow-lg hover:shadow-xl hover:-translate-y-1 disabled:opacity-70 disabled:cursor-not-allowed flex items-center gap-2",children:u?e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-5 h-5 animate-spin"}),"Saving..."]}):"Save Listing"})})]})]})}export{J as default};
