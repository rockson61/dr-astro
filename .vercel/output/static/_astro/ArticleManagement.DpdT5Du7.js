import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as n}from"./index.JXKNaeUN.js";import{c as S}from"./supabase.svVmE_Zl.js";import{G as i}from"./GlassCard.Cfd5MXeQ.js";import{G as _}from"./GlassContainer.OVLJuRR9.js";import{F as A}from"./file-text.D17FhZid.js";import{c as C}from"./createLucideIcon.BhldaWgv.js";import{C as j}from"./circle-check-big.B_c9Grz5.js";import{S as L}from"./search.BNTBrPA9.js";import{E as T,C as k}from"./external-link.C_b5xoWq.js";import{T as E}from"./trash-2.Fj75jIkq.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],F=C("funnel",D),p=S(),P={published:"bg-green-100 text-green-700",draft:"bg-gray-100 text-gray-700",pending:"bg-yellow-100 text-yellow-700",rejected:"bg-red-100 text-red-700",archived:"bg-slate-100 text-slate-700"};function V(){const[r,o]=n.useState([]),[b,m]=n.useState(!0),[d,y]=n.useState(""),[x,N]=n.useState("all"),[u,c]=n.useState(!1);n.useEffect(()=>{w()},[]);const w=async()=>{try{m(!0);const{data:t,error:s}=await p.from("articles").select(`
                    id, 
                    title, 
                    slug, 
                    status, 
                    created_at, 
                    published_at, 
                    views_count,
                    profiles!author_id (full_name, email)
                `).order("created_at",{ascending:!1});if(s)throw s;if(t){const l=t.map(a=>({id:a.id,title:a.title,slug:a.slug,status:a.status,created_at:a.created_at,published_at:a.published_at,views_count:a.views_count,author:a.profiles}));o(l)}}catch(t){console.error("Error fetching articles:",t),alert("Failed to load articles")}finally{m(!1)}},f=async(t,s)=>{if(confirm(`Are you sure you want to change status to ${s}?`))try{c(!0);const{error:l}=await p.from("articles").update({status:s,published_at:s==="published"?new Date().toISOString():null}).eq("id",t);if(l)throw l;o(r.map(a=>a.id===t?{...a,status:s}:a))}catch(l){console.error("Error updating status:",l),alert("Failed to update article status")}finally{c(!1)}},v=async t=>{if(confirm("Are you sure you want to delete this article? This cannot be undone."))try{c(!0);const{error:s}=await p.from("articles").delete().eq("id",t);if(s)throw s;o(r.filter(l=>l.id!==t))}catch(s){console.error("Error deleting article:",s),alert("Failed to delete article")}finally{c(!1)}},g=r.filter(t=>{const s=t.title.toLowerCase().includes(d.toLowerCase())||t.author?.full_name?.toLowerCase().includes(d.toLowerCase()),l=x==="all"||t.status===x;return s&&l}),h={total:r.length,pending:r.filter(t=>t.status==="pending").length,published:r.filter(t=>t.status==="published").length};return b?e.jsx("div",{className:"p-12 text-center text-gray-500",children:"Loading articles..."}):e.jsx(_,{className:"pt-24 pb-16",children:e.jsxs("div",{className:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Article Management"}),e.jsx("p",{className:"text-slate-600",children:"Review, approve, and manage community articles."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs(i,{className:"p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-bold uppercase",children:"Total Articles"}),e.jsx("p",{className:"text-3xl font-bold text-slate-800",children:h.total})]}),e.jsx(A,{className:"w-10 h-10 text-blue-500 opacity-20"})]}),e.jsxs(i,{className:"p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-yellow-600 font-bold uppercase",children:"Pending Review"}),e.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:h.pending})]}),e.jsx(F,{className:"w-10 h-10 text-yellow-500 opacity-20"})]}),e.jsxs(i,{className:"p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-600 font-bold uppercase",children:"Published"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:h.published})]}),e.jsx(j,{className:"w-10 h-10 text-green-500 opacity-20"})]})]}),e.jsx(i,{className:"p-6 mb-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between",children:[e.jsxs("div",{className:"relative flex-grow max-w-lg",children:[e.jsx(L,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by title or author...",value:d,onChange:t=>y(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none"})]}),e.jsxs("select",{value:x,onChange:t=>N(t.target.value),className:"px-4 py-2 border border-gray-200 rounded-xl outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"published",children:"Published"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]})}),e.jsx(i,{className:"!p-0 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase",children:"Article Title"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase",children:"Author"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-500 uppercase",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[g.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-slate-800",children:t.title}),e.jsxs("a",{href:`/articles/${t.slug}`,target:"_blank",className:"text-xs text-blue-500 hover:underline flex items-center gap-1 mt-1",children:["View Article ",e.jsx(T,{className:"w-3 h-3"})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-200 flex items-center justify-center text-xs font-bold text-slate-600",children:t.author?.full_name?.[0]||"?"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-slate-900",children:t.author?.full_name||"Unknown"}),e.jsx("p",{className:"text-xs text-gray-500",children:t.author?.email})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide ${P[t.status]||"bg-gray-100"}`,children:t.status})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.status!=="published"&&e.jsx("button",{onClick:()=>f(t.id,"published"),disabled:u,className:"p-2 bg-green-50 text-green-600 rounded-lg hover:bg-green-100 transition-colors title='Approve'",children:e.jsx(j,{className:"w-5 h-5"})}),t.status!=="rejected"&&e.jsx("button",{onClick:()=>f(t.id,"rejected"),disabled:u,className:"p-2 bg-yellow-50 text-yellow-600 rounded-lg hover:bg-yellow-100 transition-colors title='Reject'",children:e.jsx(k,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>v(t.id),disabled:u,className:"p-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors title='Delete'",children:e.jsx(E,{className:"w-5 h-5"})})]})})]},t.id)),g.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-500",children:"No articles found matching your criteria."})})]})]})})})]})})}export{V as default};
