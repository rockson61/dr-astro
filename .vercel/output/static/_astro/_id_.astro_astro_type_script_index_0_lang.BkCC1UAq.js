import{c as _}from"./supabase.Chw8hJPJ.js";const f=_(),a=document.getElementById("edit-form"),n=a?.querySelector('button[type="submit"]'),o=document.getElementById("delete-btn"),m=a?.dataset.id;a?.addEventListener("submit",async i=>{if(i.preventDefault(),!n)return;const r=n.textContent;n.textContent="Saving...",n.disabled=!0;const t=new FormData(a),l=t.get("title"),d=t.get("category_id"),y=t.get("excerpt"),u=t.get("content"),p=t.get("image_url"),g=t.get("tags"),b=t.get("issue_id")||null,h=g?g.split(",").map(e=>e.trim()).filter(e=>e.length>0):[];if(!l||!u||!d){alert("Please fill in all required fields (Title, Category, Content)"),n.textContent=r,n.disabled=!1;return}const w=t.get("slug"),x=t.get("status"),C=t.get("doi"),s=t.get("references");let c=[];try{c=s?JSON.parse(s):[]}catch{c=s?s.split(`
`).filter(Boolean):[]}try{const{error:e}=await f.from("articles").update({title:l,slug:w,category_id:parseInt(d),status:x||"draft",excerpt:y,content:u,image_url:p,tags:h,doi:C,references:c,issue_id:b,updated_at:new Date}).eq("id",m);if(e)throw e;window.location.href="/dashboard/my-articles"}catch(e){console.error(e),alert("Error updating article: "+e.message),n.textContent=r,n.disabled=!1}});o?.addEventListener("click",async()=>{if(!confirm("Are you sure you want to delete this article? This action cannot be undone."))return;const i=o.textContent;o.textContent="Deleting...",o.disabled=!0;try{const{error:r}=await f.from("articles").delete().eq("id",m);if(r)throw r;window.location.href="/dashboard/my-articles"}catch(r){console.error(r),alert("Error deleting article: "+r.message),o.textContent=i,o.disabled=!1}});
