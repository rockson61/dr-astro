import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r}from"./index.JXKNaeUN.js";import{c as w}from"./supabase.svVmE_Zl.js";import{G as n}from"./GlassCard.Cfd5MXeQ.js";import{G as C}from"./GlassContainer.OVLJuRR9.js";import{P as E}from"./plus.x7Bu--mN.js";import{C as S}from"./calendar.DS-ywnam.js";import{C as L}from"./circle-check-big.B_c9Grz5.js";import{C as k,E as P}from"./external-link.C_b5xoWq.js";import{S as T}from"./search.BNTBrPA9.js";import{M as D}from"./map-pin.BS-Bos_t.js";import{T as _}from"./trash-2.Fj75jIkq.js";import"./createLucideIcon.BhldaWgv.js";const m=w();function H(){const[l,o]=r.useState([]),[g,h]=r.useState(!0),[i,j]=r.useState(""),[d,b]=r.useState("all"),[u,c]=r.useState(!1);r.useEffect(()=>{y()},[]);const y=async()=>{try{h(!0);const{data:t,error:s}=await m.from("events").select("*").order("start_date",{ascending:!0});if(s)throw s;t&&o(t)}catch(t){console.error("Error fetching events:",t),alert("Failed to load events")}finally{h(!1)}},N=async(t,s)=>{try{c(!0);const{error:a}=await m.from("events").update({status:s}).eq("id",t);if(a)throw a;o(l.map(p=>p.id===t?{...p,status:s}:p))}catch(a){console.error("Error updating event status:",a),alert("Failed to update status")}finally{c(!1)}},v=async t=>{if(confirm("Are you sure you want to delete this event? This cannot be undone."))try{c(!0);const{error:s}=await m.from("events").delete().eq("id",t);if(s)throw s;o(l.filter(a=>a.id!==t))}catch(s){console.error("Error deleting event:",s),alert("Failed to delete event")}finally{c(!1)}},f=l.filter(t=>{const s=t.title.toLowerCase().includes(i.toLowerCase())||t.location_name?.toLowerCase().includes(i.toLowerCase()),a=d==="all"||t.status===d;return s&&a}),x={total:l.length,upcoming:l.filter(t=>t.status==="upcoming").length,cancelled:l.filter(t=>t.status==="cancelled").length};return g?e.jsx("div",{className:"p-12 text-center text-gray-500",children:"Loading events..."}):e.jsx(C,{className:"pt-24 pb-16",children:e.jsxs("div",{className:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Event Management"}),e.jsx("p",{className:"text-slate-600",children:"Coordinate and manage dental events."})]}),e.jsxs("a",{href:"/dashboard/events/new",className:"px-6 py-3 bg-tuio-red text-white rounded-xl font-bold uppercase tracking-wide hover:bg-tuio-navy transition-all shadow-lg flex items-center gap-2",children:[e.jsx(E,{className:"w-5 h-5"}),"Create Event"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs(n,{className:"p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-bold uppercase",children:"Total Events"}),e.jsx("p",{className:"text-3xl font-bold text-slate-800",children:x.total})]}),e.jsx(S,{className:"w-10 h-10 text-blue-500 opacity-20"})]}),e.jsxs(n,{className:"p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-600 font-bold uppercase",children:"Upcoming"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:x.upcoming})]}),e.jsx(L,{className:"w-10 h-10 text-green-500 opacity-20"})]}),e.jsxs(n,{className:"p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-red-600 font-bold uppercase",children:"Cancelled"}),e.jsx("p",{className:"text-3xl font-bold text-red-600",children:x.cancelled})]}),e.jsx(k,{className:"w-10 h-10 text-red-500 opacity-20"})]})]}),e.jsx(n,{className:"p-6 mb-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between",children:[e.jsxs("div",{className:"relative flex-grow max-w-lg",children:[e.jsx(T,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by event title or location...",value:i,onChange:t=>j(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none"})]}),e.jsxs("select",{value:d,onChange:t=>b(t.target.value),className:"px-4 py-2 border border-gray-200 rounded-xl outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Events"}),e.jsx("option",{value:"upcoming",children:"Upcoming"}),e.jsx("option",{value:"past",children:"Past"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})}),e.jsx(n,{className:"!p-0 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase",children:"Event Details"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase",children:"Location"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-500 uppercase",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[f.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-slate-800",children:t.title}),e.jsx("span",{className:"text-sm text-gray-600 uppercase tracking-wider text-xs font-bold text-tuio-red",children:t.type}),e.jsxs("a",{href:`/events/${t.slug}`,target:"_blank",className:"text-xs text-blue-500 hover:underline flex items-center gap-1 mt-1",children:["View Event ",e.jsx(P,{className:"w-3 h-3"})]})]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-gray-400"}),t.is_virtual?"Virtual Event":t.location_name||"TBA"]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("select",{value:t.status,onChange:s=>N(t.id,s.target.value),disabled:u,className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide border-none outline-none cursor-pointer ${t.status==="upcoming"?"bg-green-100 text-green-700":t.status==="cancelled"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-500"}`,children:[e.jsx("option",{value:"upcoming",children:"Upcoming"}),e.jsx("option",{value:"past",children:"Past"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:new Date(t.start_date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("button",{onClick:()=>v(t.id),disabled:u,className:"p-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors title='Delete'",children:e.jsx(_,{className:"w-5 h-5"})})})]},t.id)),f.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-500",children:"No events found."})})]})]})})})]})})}export{H as default};
