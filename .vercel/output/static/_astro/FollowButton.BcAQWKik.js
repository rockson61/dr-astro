import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as i}from"./index.JXKNaeUN.js";import{c as h}from"./supabase.C4yJ2ZhP.js";import{L as p}from"./loader-circle.ofVaKFwt.js";import{c as f}from"./createLucideIcon.BhldaWgv.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],g=f("user-check",y);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],k=f("user-plus",x),r=h();function q({targetUserId:s,targetUserName:v}){const[n,a]=i.useState(!1),[c,t]=i.useState(!0),[l,d]=i.useState(null);i.useEffect(()=>{u()},[s]);const u=async()=>{const{data:{user:o}}=await r.auth.getUser();if(!o){t(!1);return}if(d(o.id),o.id===s){t(!1);return}const{data:m}=await r.from("follows").select("*").eq("follower_id",o.id).eq("following_id",s).single();m&&a(!0),t(!1)},w=async()=>{if(!l){window.location.href="/login";return}if(t(!0),n){const{error:o}=await r.from("follows").delete().eq("follower_id",l).eq("following_id",s);o||a(!1)}else{const{error:o}=await r.from("follows").insert({follower_id:l,following_id:s});o||(a(!0),await r.from("notifications").insert({user_id:s,type:"follow",title:"New Follower",message:"Someone started following you!",link:`/profile/${l}`,is_read:!1}))}t(!1)};return!l||l===s?null:e.jsx("button",{onClick:w,disabled:c,className:`px-4 py-2 rounded-full font-bold text-sm transition-all flex items-center gap-2 ${n?"bg-gray-100 text-gray-600 hover:bg-gray-200 hover:text-red-500 group":"bg-tuio-red text-white hover:bg-tuio-navy shadow-md hover:shadow-lg"}`,children:c?e.jsx(p,{size:16,className:"animate-spin"}):n?e.jsxs(e.Fragment,{children:[e.jsx(g,{size:16,className:"group-hover:hidden"}),e.jsx("span",{className:"group-hover:hidden",children:"Following"}),e.jsx("span",{className:"hidden group-hover:inline",children:"Unfollow"})]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{size:16}),e.jsx("span",{children:"Follow"})]})})}export{q as default};
