import{c as w}from"./supabase.Chw8hJPJ.js";const C=w(),s=document.querySelector("form"),r=s?.querySelector('button[type="submit"]');s?.addEventListener("submit",async u=>{if(u.preventDefault(),!r)return;const a=r.textContent;r.textContent="Publishing...",r.disabled=!0;const t=new FormData(s),i=t.get("title"),c=t.get("category_id"),f=t.get("type")||"article",p=t.get("excerpt"),l=t.get("content"),d=t.get("tags"),m=t.get("issue_id")||null,y=d?d.split(",").map(e=>e.trim()).filter(e=>e.length>0):[],h=t.get("doi"),n=t.get("references");let o=[];try{o=n?JSON.parse(n):[]}catch{o=n?n.split(`
`).filter(Boolean):[]}if(!i||!l||!c){alert("Please fill in all required fields (Title, Category, Content)"),r.textContent=a,r.disabled=!1;return}try{const{data:{user:e}}=await C.auth.getUser();if(!e)throw new Error("Not authenticated");const g=await fetch("/api/articles/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:i,category_id:c,type:f,excerpt:p,content:l,tags:y,doi:h,references:o,issue_id:m,image:null})}),b=await g.json();if(!g.ok)throw new Error(b.error);window.location.href="/dashboard/my-articles"}catch(e){console.error(e),alert("Error publishing article: "+e.message),r.textContent=a,r.disabled=!1}});
