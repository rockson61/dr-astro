import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as n}from"./index.JXKNaeUN.js";import{s as _}from"./supabase.svVmE_Zl.js";import{S as b}from"./star.DSE2cwhi.js";import{c as $}from"./createLucideIcon.BhldaWgv.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=[["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}],["path",{d:"M7 10v12",key:"1qc93n"}]],M=$("thumbs-up",k),A=({profileId:h,onRatingDataUpdate:o,minimal:g=!1,limit:d,initialReviews:c=[]})=>{const[a,j]=n.useState(c),[y,u]=n.useState(c.length===0),[l,m]=n.useState("recent");n.useEffect(()=>{c.length===0&&(async()=>{u(!0);const{data:s,error:r}=await _.from("profile_ratings").select("*, rater:rater_id(first_name, last_name, avatar_url)").eq("profile_id",h).order("created_at",{ascending:!1});if(!r&&s){j(s);const x=s.reduce((i,w)=>i+(w.rating||0),0)/s.length;o&&o(x||0,s.length)}u(!1)})()},[h,o,c.length]);const v=n.useMemo(()=>{const t={5:0,4:0,3:0,2:0,1:0};return a.forEach(s=>{const r=Math.round(s.rating);r>=1&&r<=5&&t[r]++}),t},[a]),f=n.useMemo(()=>a.length===0?0:a.reduce((t,s)=>t+(s.rating||0),0)/a.length,[a]),N=n.useMemo(()=>{const t=[...a];return l==="highest"?t.sort((s,r)=>(r.rating||0)-(s.rating||0)):l==="lowest"&&t.sort((s,r)=>(s.rating||0)-(r.rating||0)),d?t.slice(0,d):t},[a,l,d]),p=(t,s="sm")=>{const r=[],x=s==="lg"?"w-7 h-7":"w-4 h-4";for(let i=1;i<=5;i++)r.push(e.jsx(b,{className:`${x} ${i<=t?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},i));return r};return y?e.jsx("div",{className:"bg-white rounded-[24px] shadow-sm p-6 mb-6",children:e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading reviews..."})}):a.length?e.jsxs("div",{className:`${g?"":"bg-white rounded-[24px] shadow-sm p-6 mb-6"}`,children:[!g&&e.jsxs(e.Fragment,{children:[e.jsxs("h2",{className:"text-2xl font-tuio uppercase text-tuio-navy mb-6",children:["Reviews (",a.length,")"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8 pb-8 border-b border-gray-100",children:[e.jsx("div",{className:"flex items-center gap-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-5xl font-bold text-tuio-navy mb-1",children:f.toFixed(1)}),e.jsx("div",{className:"flex items-center justify-center gap-1 mb-2",children:p(Math.round(f),"lg")}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["Based on ",a.length," ",a.length===1?"review":"reviews"]})]})}),e.jsx("div",{className:"space-y-2",children:[5,4,3,2,1].map(t=>{const s=v[t],r=a.length>0?s/a.length*100:0;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 w-12",children:[t," stars"]}),e.jsx("div",{className:"flex-1 h-3 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-yellow-400 transition-all duration-300",style:{width:`${r}%`}})}),e.jsx("span",{className:"text-sm text-gray-600 w-12 text-right",children:s})]},t)})})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 mb-6",children:[e.jsx("button",{onClick:()=>m("recent"),className:`px-4 py-2 rounded-full font-bold text-sm uppercase tracking-wide transition-colors ${l==="recent"?"bg-tuio-navy text-white":"bg-tuio-bg text-tuio-navy hover:bg-gray-200"}`,children:"Most Recent"}),e.jsx("button",{onClick:()=>m("highest"),className:`px-4 py-2 rounded-full font-bold text-sm uppercase tracking-wide transition-colors ${l==="highest"?"bg-tuio-navy text-white":"bg-tuio-bg text-tuio-navy hover:bg-gray-200"}`,children:"Highest Rated"}),e.jsx("button",{onClick:()=>m("lowest"),className:`px-4 py-2 rounded-full font-bold text-sm uppercase tracking-wide transition-colors ${l==="lowest"?"bg-tuio-navy text-white":"bg-tuio-bg text-tuio-navy hover:bg-gray-200"}`,children:"Lowest Rated"})]})]}),e.jsx("div",{className:"space-y-6",children:N.map(t=>e.jsx("div",{className:"border-b border-gray-100 last:border-0 pb-6 last:pb-0",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:t.rater?.avatar_url?e.jsx("img",{src:t.rater.avatar_url,alt:`${t.rater.first_name} ${t.rater.last_name}`,className:"w-12 h-12 rounded-full object-cover"}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-tuio-red flex items-center justify-center text-lg font-bold text-white",children:`${t.rater?.first_name||""} ${t.rater?.last_name||""}`.charAt(0)||"?"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-bold text-tuio-navy",children:t.rater?.first_name?`${t.rater.first_name} ${t.rater.last_name}`:"Anonymous User"}),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(t.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})]}),e.jsx("div",{className:"flex items-center gap-1 mb-3",children:p(t.rating)}),t.comment&&e.jsx("p",{className:"text-gray-700 leading-relaxed mb-3",children:t.comment}),e.jsxs("button",{className:"flex items-center gap-2 text-gray-500 hover:text-tuio-red transition-colors",children:[e.jsx(M,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Helpful"})]})]})]})},t.id))})]}):e.jsxs("div",{className:"bg-white rounded-[24px] shadow-sm p-6 mb-6",children:[e.jsx("h2",{className:"text-2xl font-tuio uppercase text-tuio-navy mb-4",children:"Reviews"}),e.jsxs("div",{className:"text-center py-12 bg-tuio-bg rounded-xl",children:[e.jsx(b,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mb-2 text-lg font-medium",children:"No reviews yet"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Be the first to leave a review!"})]})]})};export{A as default};
