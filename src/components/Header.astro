---
interface Props {
    currentPath?: string;
}

const { currentPath = Astro.url.pathname } = Astro.props;

const navLinks = [
    { 
        label: 'Explore', 
        href: '#',
        megaMenu: [
            { section: 'Content', items: [
                { label: 'News', href: '/news', icon: 'üì∞', desc: 'Latest industry updates' },
                { label: 'Articles', href: '/articles', icon: 'üìù', desc: 'Clinical insights & research' },
                { label: 'Guides', href: '/guides', icon: 'üìö', desc: 'How-to resources' },
                { label: 'Podcasts', href: '/podcasts', icon: 'üéôÔ∏è', desc: 'Audio conversations' },
            ]},
            { section: 'Community', items: [
                { label: 'Directory', href: '/directory', icon: 'üè¢', desc: 'Find clinics & labs' },
                { label: 'Community', href: '/community', icon: 'üë•', desc: 'Connect with peers' },
                { label: 'Events', href: '/events', icon: 'üìÖ', desc: 'Conferences & webinars' },
                { label: 'Awards', href: '/awards', icon: 'üèÜ', desc: 'Recognition program' },
            ]},
        ]
    },
    { label: 'Jobs', href: '/jobs' },
    { label: 'Products', href: '/products' },
    { label: 'About', href: '/about' },
];
---

<header class="fixed top-0 left-0 right-0 z-50 transition-all duration-300" id="main-header">
    <div class="bg-tuio-navy/95 backdrop-blur-xl border-b border-white/10">
        <div class="container mx-auto px-4">
            <div class="h-20 flex items-center justify-between">
                <!-- Logo -->
                <a href="/" class="flex items-center gap-3 group">
                    <div class="w-10 h-10 bg-tuio-pink rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform">
                        <span class="text-white font-tuio text-xl">D</span>
                    </div>
                    <span class="font-tuio text-xl uppercase text-white hidden sm:block">DentalReach</span>
                </a>

                <!-- Desktop Navigation -->
                <nav class="hidden lg:flex items-center gap-2">
                    {navLinks.map((link) => (
                        <div class="relative group">
                            <a 
                                href={link.href} 
                                class={`px-4 py-2 rounded-full text-sm font-medium transition-all flex items-center gap-1 ${
                                    currentPath === link.href 
                                        ? 'bg-tuio-pink text-white' 
                                        : 'text-white/80 hover:text-white hover:bg-white/10'
                                }`}
                            >
                                {link.label}
                                {link.megaMenu && (
                                    <svg class="w-4 h-4 group-hover:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                                    </svg>
                                )}
                            </a>
                            
                            {link.megaMenu && (
                                <div class="absolute top-full left-0 pt-4 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 transform group-hover:translate-y-0 translate-y-2">
                                    <div class="bg-white rounded-[24px] shadow-2xl p-6 min-w-[480px] grid grid-cols-2 gap-6">
                                        {link.megaMenu.map((section) => (
                                            <div>
                                                <h4 class="text-xs font-bold uppercase tracking-widest text-gray-400 mb-4">{section.section}</h4>
                                                <div class="space-y-2">
                                                    {section.items.map((item) => (
                                                        <a href={item.href} class="flex items-start gap-3 p-3 rounded-xl hover:bg-tuio-bg transition-colors group/item">
                                                            <span class="text-xl">{item.icon}</span>
                                                            <div>
                                                                <span class="font-bold text-tuio-navy group-hover/item:text-tuio-pink transition-colors">{item.label}</span>
                                                                <p class="text-xs text-gray-500">{item.desc}</p>
                                                            </div>
                                                        </a>
                                                    ))}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </div>
                    ))}
                </nav>

                <!-- Right Side -->
                <div class="flex items-center gap-3">
                    <!-- Search -->
                    <a href="/search" class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center text-white hover:bg-tuio-pink transition-colors">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                        </svg>
                    </a>
                    
                    <!-- Login/Dashboard -->
                    <a href="/login" class="hidden sm:flex px-6 py-2.5 rounded-full bg-tuio-pink text-white font-bold uppercase tracking-wide text-sm hover:bg-white hover:text-tuio-pink transition-all">
                        Login
                    </a>

                    <!-- Mobile Menu Toggle -->
                    <button id="mobile-menu-toggle" class="lg:hidden w-10 h-10 rounded-full bg-white/10 flex items-center justify-center text-white">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" id="menu-icon">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                        <svg class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" id="close-icon">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="lg:hidden hidden bg-tuio-navy border-t border-white/10">
        <div class="container mx-auto px-4 py-6 space-y-4">
            {navLinks.map((link) => (
                <div>
                    {link.megaMenu ? (
                        <div class="space-y-2">
                            <span class="text-white/50 text-sm font-bold uppercase tracking-widest">{link.label}</span>
                            <div class="grid grid-cols-2 gap-2">
                                {link.megaMenu.map(section => section.items.map(item => (
                                    <a href={item.href} class="flex items-center gap-2 p-3 rounded-xl bg-white/5 hover:bg-tuio-pink text-white transition-colors">
                                        <span>{item.icon}</span>
                                        <span class="text-sm font-medium">{item.label}</span>
                                    </a>
                                )))}
                            </div>
                        </div>
                    ) : (
                        <a href={link.href} class="block py-3 text-white font-medium hover:text-tuio-pink transition-colors">
                            {link.label}
                        </a>
                    )}
                </div>
            ))}
            <a href="/login" class="block w-full text-center py-3 rounded-full bg-tuio-pink text-white font-bold uppercase tracking-wide">
                Login
            </a>
        </div>
    </div>
</header>

<!-- Spacer for fixed header -->
<div class="h-20"></div>

<script>
    const toggle = document.getElementById('mobile-menu-toggle');
    const mobileMenu = document.getElementById('mobile-menu');
    const menuIcon = document.getElementById('menu-icon');
    const closeIcon = document.getElementById('close-icon');
    
    toggle?.addEventListener('click', () => {
        mobileMenu?.classList.toggle('hidden');
        menuIcon?.classList.toggle('hidden');
        closeIcon?.classList.toggle('hidden');
    });

    // Header scroll effect
    const header = document.getElementById('main-header');
    let lastScroll = 0;
    
    window.addEventListener('scroll', () => {
        const currentScroll = window.scrollY;
        
        if (currentScroll > 100) {
            header?.classList.add('shadow-xl');
        } else {
            header?.classList.remove('shadow-xl');
        }
        
        lastScroll = currentScroll;
    });
</script>
